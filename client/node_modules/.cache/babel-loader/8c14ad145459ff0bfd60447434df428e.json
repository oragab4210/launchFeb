{"ast":null,"code":"import _slicedToArray from\"/Users/omarragab/Documents/Job/ResumeProject1/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import styles from\"./TestDropDown.module.css\";import React,{useState,useEffect,useRef,useContext,FC,SetStateAction,Dispatch}from\"react\";import{useAppSelector,useAppDispatch}from\"../../../redux/hooks\";import{setCurrentUser}from\"../../../redux/features/currentUserSlice\";import{Link,useLocation}from\"react-router-dom\";import{useQuery,useMutation}from\"@apollo/client\";import currentUserQuery from\"../../../GQL/queries/CurrentUser\";import mutation from\"../../../GQL/mutations/Logout\";import profile from\"./profile.png\";// import socketIOClient from \"socket.io-client\";\n// const SOCKET_SERVER_URL = \"http://localhost:4000\";\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TestDropDown=function TestDropDown(_ref){var socketRef=_ref.socketRef,socketIdFromNav=_ref.socketIdFromNav;var _useQuery=useQuery(currentUserQuery),loading=_useQuery.loading,error=_useQuery.error,data=_useQuery.data,refetch=_useQuery.refetch;var _useMutation=useMutation(mutation),_useMutation2=_slicedToArray(_useMutation,1),logout=_useMutation2[0];var currentUser=useAppSelector(function(state){return state.currentUser;});var _useLocation=useLocation(),pathname=_useLocation.pathname;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),close=_useState4[0],setClose=_useState4[1];var _useState5=useState(pathname),_useState6=_slicedToArray(_useState5,2),currentPath=_useState6[0],setCurrentPath=_useState6[1];var dispatch=useAppDispatch();// const socketRef = useRef();\n// useEffect(() => {\n//   if (open) {\n//   }\n// }, [pathname]);\nuseEffect(function(){document.addEventListener(\"click\",handleClickOutside,false);return function(){document.removeEventListener(\"click\",handleClickOutside,false);};},[]);var wrapperRef=useRef(null);var onLogoutCLick=function onLogoutCLick(){// socketRef.current.emit(\"logout\", { socketId: socketIdFromNav });\n// socketRef.current.disconnect(true);\nlogout({refetchQueries:[{query:currentUserQuery}],awaitRefetchQueries:true}).then(socketRef.current.emit(\"refetchOnlineUsers\",{})).then(socketRef.current.disconnect(true)).then(dispatch(setCurrentUser({}))).catch(function(err){return console.log(err);});};var handleClickOutside=function handleClickOutside(event){if(wrapperRef.current&&!wrapperRef.current.contains(event.target)){setOpen(false);// setClose(true);\n}};// console.log(socketRef);\nreturn/*#__PURE__*/_jsxs(\"div\",{className:styles.container,ref:wrapperRef,onMouseLeave:function onMouseLeave(){return[setOpen(false),setClose(true)];},children:[/*#__PURE__*/_jsx(\"div\",{className:styles.profilePicContainer,children:/*#__PURE__*/_jsx(\"img\",{src:profile,alt:\"\",className:styles.profilePic,onMouseOver:function onMouseOver(){return setOpen(true);}// onMouseLeave={() => setOpen(false)}\n})}),/*#__PURE__*/_jsx(\"div\",{// onMouseLeave={() => setOpen(false)}\nclassName:\"\".concat(styles.profileDropdownContainer,\" \").concat(open?// && currentPath === pathname\nstyles.active:close?styles.deactivated:// && styles.active\nnull,\"  \"),children:/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(styles.profileDropdownContainer1),children:/*#__PURE__*/_jsxs(\"ul\",{className:\"\".concat(styles.profileDropdownList,\" \").concat(open?styles.active:null),children:[/*#__PURE__*/_jsx(\"li\",{onClick:function onClick(){return[setOpen(false),setClose(true)];},children:/*#__PURE__*/_jsx(Link,{to:\"/profile\",className:\"\".concat(styles.option,\" \").concat(open?styles.active:null),children:\"Profile\"})}),/*#__PURE__*/_jsx(\"li\",{onClick:function onClick(){return[onLogoutCLick(),setOpen(false),setClose(true)];},children:/*#__PURE__*/_jsx(Link,{to:\"/login\",className:\"\".concat(styles.option,\" \").concat(open?styles.active:null),children:\"Log Out\"})})]})})})]});};export default TestDropDown;","map":{"version":3,"sources":["/Users/omarragab/Documents/Job/ResumeProject1/client/src/components/Navigation/TestDropDown/TestDropDown.js"],"names":["styles","React","useState","useEffect","useRef","useContext","FC","SetStateAction","Dispatch","useAppSelector","useAppDispatch","setCurrentUser","Link","useLocation","useQuery","useMutation","currentUserQuery","mutation","profile","TestDropDown","socketRef","socketIdFromNav","loading","error","data","refetch","logout","currentUser","state","pathname","open","setOpen","close","setClose","currentPath","setCurrentPath","dispatch","document","addEventListener","handleClickOutside","removeEventListener","wrapperRef","onLogoutCLick","refetchQueries","query","awaitRefetchQueries","then","current","emit","disconnect","catch","err","console","log","event","contains","target","container","profilePicContainer","profilePic","profileDropdownContainer","active","deactivated","profileDropdownContainer1","profileDropdownList","option"],"mappings":"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","sourcesContent":["import styles from \"./TestDropDown.module.css\";\nimport React, {\n  useState,\n  useEffect,\n  useRef,\n  useContext,\n  FC,\n  SetStateAction,\n  Dispatch,\n} from \"react\";\nimport { useAppSelector, useAppDispatch } from \"../../../redux/hooks\";\nimport { setCurrentUser } from \"../../../redux/features/currentUserSlice\";\nimport { Link, useLocation } from \"react-router-dom\";\nimport { useQuery, useMutation } from \"@apollo/client\";\nimport currentUserQuery from \"../../../GQL/queries/CurrentUser\";\nimport mutation from \"../../../GQL/mutations/Logout\";\nimport profile from \"./profile.png\";\n\n// import socketIOClient from \"socket.io-client\";\n// const SOCKET_SERVER_URL = \"http://localhost:4000\";\n\nconst TestDropDown = ({ socketRef, socketIdFromNav }) => {\n  let { loading, error, data, refetch } = useQuery(currentUserQuery);\n  let [logout] = useMutation(mutation);\n  const currentUser = useAppSelector((state) => state.currentUser);\n  const { pathname } = useLocation();\n  const [open, setOpen] = useState(false);\n  const [close, setClose] = useState(false);\n  const [currentPath, setCurrentPath] = useState(pathname);\n  const dispatch = useAppDispatch();\n  // const socketRef = useRef();\n\n  // useEffect(() => {\n  //   if (open) {\n  //   }\n  // }, [pathname]);\n\n  useEffect(() => {\n    document.addEventListener(\"click\", handleClickOutside, false);\n    return () => {\n      document.removeEventListener(\"click\", handleClickOutside, false);\n    };\n  }, []);\n\n  const wrapperRef = useRef(null);\n\n  const onLogoutCLick = () => {\n    // socketRef.current.emit(\"logout\", { socketId: socketIdFromNav });\n    // socketRef.current.disconnect(true);\n\n    logout({\n      refetchQueries: [{ query: currentUserQuery }],\n      awaitRefetchQueries: true,\n    })\n      .then(socketRef.current.emit(\"refetchOnlineUsers\", {}))\n      .then(socketRef.current.disconnect(true))\n      .then(dispatch(setCurrentUser({})))\n\n      .catch((err) => console.log(err));\n  };\n  const handleClickOutside = (event) => {\n    if (wrapperRef.current && !wrapperRef.current.contains(event.target)) {\n      setOpen(false);\n      // setClose(true);\n    }\n  };\n  // console.log(socketRef);\n\n  return (\n    <div\n      className={styles.container}\n      ref={wrapperRef}\n      onMouseLeave={() => [setOpen(false), setClose(true)]}\n    >\n      <div className={styles.profilePicContainer}>\n        <img\n          src={profile}\n          alt=\"\"\n          className={styles.profilePic}\n          onMouseOver={() => setOpen(true)}\n          // onMouseLeave={() => setOpen(false)}\n        />\n      </div>\n      {/* -------------------------------------------------------------------------- */}\n\n      <div\n        // onMouseLeave={() => setOpen(false)}\n        className={`${styles.profileDropdownContainer} ${\n          open\n            ? // && currentPath === pathname\n              styles.active\n            : close\n            ? styles.deactivated\n            : // && styles.active\n              null\n        }  `}\n      >\n        <div className={`${styles.profileDropdownContainer1}`}>\n          <ul\n            className={`${styles.profileDropdownList} ${\n              open ? styles.active : null\n            }`}\n          >\n            <li onClick={() => [setOpen(false), setClose(true)]}>\n              <Link\n                to=\"/profile\"\n                className={`${styles.option} ${open ? styles.active : null}`}\n              >\n                Profile\n              </Link>\n            </li>\n            <li\n              onClick={() => [onLogoutCLick(), setOpen(false), setClose(true)]}\n            >\n              <Link\n                to=\"/login\"\n                className={`${styles.option} ${open ? styles.active : null}`}\n              >\n                Log Out\n              </Link>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default TestDropDown;\n"]},"metadata":{},"sourceType":"module"}