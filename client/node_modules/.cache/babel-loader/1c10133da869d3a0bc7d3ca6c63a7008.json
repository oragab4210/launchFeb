{"ast":null,"code":"import styles from\"./NavBar.module.css\";import React,{useState,useEffect,useRef}from\"react\";import SideNav from\"../SideNav/SideNav\";import{useQuery,useMutation}from\"@apollo/client\";import{setCurrentUser}from\"../../../redux/features/currentUserSlice\";import{setOnlineUsers}from\"../../../redux/features/onlineUsersSlice\";import currentUserQuery from\"../../../GQL/queries/CurrentUser\";import{setSocket}from\"../../../redux/features/socketSlice\";import{useAppSelector,useAppDispatch}from\"../../../redux/hooks\";import{Link,useLocation}from\"react-router-dom\";import mutation from\"../../../GQL/mutations/Logout\";import ProfileDropdownInitiator from\"../ProfileDropdownInitiator/ProfileDropdownInitiator\";import TestDropDown from\"../TestDropDown/TestDropDown\";import socketIOClient from\"socket.io-client\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SOCKET_SERVER_URL=\"http://localhost:4000\";var NavBar=function NavBar(){var _useLocation=useLocation(),pathname=_useLocation.pathname;var dontShowUp=[\"/\",\"/login\"];var navShow=!dontShowUp.includes(pathname);var _useQuery=useQuery(currentUserQuery),loading=_useQuery.loading,error=_useQuery.error,data=_useQuery.data,refetch=_useQuery.refetch;var currentUser=useAppSelector(function(state){return state.currentUser;});var dispatch=useAppDispatch();var socketRef=useRef();/* -------------------------------------------------------------------------- */useEffect(function(){refetch();if(data){console.log(data.user2,\"NavBar\");dispatch(setCurrentUser(data.user2));}},[data]);useEffect(function(){if(navShow&&currentUser.id){console.log(\"working\");socketRef.current=socketIOClient(SOCKET_SERVER_URL);socketRef.current.emit(\"login\",{userId:currentUser.id});socketRef.current.on(\"onlineUsers\",function(data){var onlineUsers=Object.entries(data);var onlineIds=Array.from(onlineUsers,function(x){return x[1];});console.log(onlineIds);dispatch(setOnlineUsers(onlineIds));});}},[currentUser,data,navShow]);/* -------------------------------------------------------------------------- */return/*#__PURE__*/_jsxs(\"div\",{className:styles.container0,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.container,children:[/*#__PURE__*/_jsx(SideNav,{}),/*#__PURE__*/_jsx(ProfileDropdownInitiator,{})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.container69,children:[/*#__PURE__*/_jsx(SideNav,{}),/*#__PURE__*/_jsx(TestDropDown,{socketRef:socketRef})]})]});};export default NavBar;","map":{"version":3,"sources":["/Users/omarragab/Documents/test/launchFeb/client/src/components/Navigation/NavBar/NavBar.js"],"names":["styles","React","useState","useEffect","useRef","SideNav","useQuery","useMutation","setCurrentUser","setOnlineUsers","currentUserQuery","setSocket","useAppSelector","useAppDispatch","Link","useLocation","mutation","ProfileDropdownInitiator","TestDropDown","socketIOClient","SOCKET_SERVER_URL","NavBar","pathname","dontShowUp","navShow","includes","loading","error","data","refetch","currentUser","state","dispatch","socketRef","console","log","user2","id","current","emit","userId","on","onlineUsers","Object","entries","onlineIds","Array","from","x","container0","container","container69"],"mappings":"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","sourcesContent":["import styles from \"./NavBar.module.css\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport SideNav from \"../SideNav/SideNav\";\n\nimport { useQuery, useMutation } from \"@apollo/client\";\nimport { setCurrentUser } from \"../../../redux/features/currentUserSlice\";\nimport { setOnlineUsers } from \"../../../redux/features/onlineUsersSlice\";\nimport currentUserQuery from \"../../../GQL/queries/CurrentUser\";\nimport { setSocket } from \"../../../redux/features/socketSlice\";\nimport { useAppSelector, useAppDispatch } from \"../../../redux/hooks\";\nimport { Link, useLocation } from \"react-router-dom\";\nimport mutation from \"../../../GQL/mutations/Logout\";\nimport ProfileDropdownInitiator from \"../ProfileDropdownInitiator/ProfileDropdownInitiator\";\nimport TestDropDown from \"../TestDropDown/TestDropDown\";\nimport socketIOClient from \"socket.io-client\";\nconst SOCKET_SERVER_URL = \"http://localhost:4000\";\n\nconst NavBar = () => {\n  const { pathname } = useLocation();\n  const dontShowUp = [\"/\", \"/login\"];\n  const navShow = !dontShowUp.includes(pathname);\n  let { loading, error, data, refetch } = useQuery(currentUserQuery);\n  const currentUser = useAppSelector((state) => state.currentUser);\n  const dispatch = useAppDispatch();\n  const socketRef = useRef();\n\n  /* -------------------------------------------------------------------------- */\n  useEffect(() => {\n    refetch();\n    if (data) {\n      console.log(data.user2, \"NavBar\");\n      dispatch(setCurrentUser(data.user2));\n    }\n  }, [data]);\n\n  useEffect(() => {\n    if (navShow && currentUser.id) {\n      console.log(\"working\");\n      socketRef.current = socketIOClient(SOCKET_SERVER_URL);\n      socketRef.current.emit(\"login\", { userId: currentUser.id });\n      socketRef.current.on(\"onlineUsers\", (data) => {\n        const onlineUsers = Object.entries(data);\n        const onlineIds = Array.from(onlineUsers, (x) => x[1]);\n        console.log(onlineIds);\n        dispatch(setOnlineUsers(onlineIds));\n      });\n    }\n  }, [currentUser, data, navShow]);\n\n  /* -------------------------------------------------------------------------- */\n\n  return (\n    <div className={styles.container0}>\n      <div className={styles.container}>\n        <SideNav />\n        <ProfileDropdownInitiator />\n      </div>\n      <div className={styles.container69}>\n        <SideNav />\n        <TestDropDown socketRef={socketRef} />\n      </div>\n    </div>\n  );\n};\n\nexport default NavBar;\n"]},"metadata":{},"sourceType":"module"}