{"ast":null,"code":"import _slicedToArray from\"/Users/omarragab/Documents/Job/ResumeProject1/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import styles from\"./EditDeleteComment.module.css\";import React,{useState,useEffect,useRef}from\"react\";import{Modal}from\"./modal/modal\";import{useAppSelector,useAppDispatch}from\"../../../../redux/hooks\";import X_SVG from\"./x.svg\";import{useMutation,useQuery}from\"@apollo/client\";import editCommentMutation from\"../../../../GQL/mutations/editComment\";import deleteCommentMutation from\"../../../../GQL/mutations/deleteComment\";import currentUserQuery from\"../../../../GQL/queries/CurrentUser\";import editPostMutation from\"../../../../GQL/mutations/editPost\";import LoadingSpinner from\"../../../LoadingSpinner/LoadingSpinner\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var EditDeleteComment=function EditDeleteComment(_ref){var comment=_ref.comment;var _useMutation=useMutation(editCommentMutation),_useMutation2=_slicedToArray(_useMutation,1),editComment=_useMutation2[0];var _useMutation3=useMutation(deleteCommentMutation),_useMutation4=_slicedToArray(_useMutation3,1),deleteComment=_useMutation4[0];var _useMutation5=useMutation(editPostMutation),_useMutation6=_slicedToArray(_useMutation5,1),editPost=_useMutation6[0];// const { refetch } = useQuery(currentUserQuery);\nvar currentUser=useAppSelector(function(state){return state.currentUser;});var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showModal=_useState2[0],setShowModal=_useState2[1];var _useState3=useState(comment.comment),_useState4=_slicedToArray(_useState3,2),commentText=_useState4[0],setCommentText=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];useEffect(function(){setCommentText(comment.comment);},[comment]);var editCommentOnClick=function editCommentOnClick(){setLoading(true);editComment({variables:{id:comment.id,comment:commentText},refetchQueries:[{query:currentUserQuery}],awaitRefetchQueries:true}).then(function(res){return[setShowModal(false),setLoading(false)];}).catch(function(err){var _err$graphQLErrors;var errors=(_err$graphQLErrors=err.graphQLErrors)===null||_err$graphQLErrors===void 0?void 0:_err$graphQLErrors.map(function(error){return error.message;});console.log(errors);});};var deleteCommentOnClick=function deleteCommentOnClick(e){setLoading(true);console.log(\"start\");/* ----------------------------- delete comment ----------------------------- */deleteComment({variables:{id:comment.id},refetchQueries:[{query:currentUserQuery}],awaitRefetchQueries:true})/* -----------------------------Delete Comment from Post--------------------------------------------- */.then(function(res){return editPost({variables:{id:comment.postId,deleteComment:comment.id},refetchQueries:[{query:currentUserQuery}],awaitRefetchQueries:true}).then([setShowModal(false),setLoading(false)]).catch(function(err){var _err$graphQLErrors2;var errors=(_err$graphQLErrors2=err.graphQLErrors)===null||_err$graphQLErrors2===void 0?void 0:_err$graphQLErrors2.map(function(error){return error.message;});console.log(errors);});}).catch(function(err){var _err$graphQLErrors3;var errors=(_err$graphQLErrors3=err.graphQLErrors)===null||_err$graphQLErrors3===void 0?void 0:_err$graphQLErrors3.map(function(error){return error.message;});console.log(errors);});};if(!showModal)return/*#__PURE__*/_jsx(\"div\",{onClick:function onClick(){return setShowModal(true);},children:\"...\"});return/*#__PURE__*/_jsx(Modal,{showModal:showModal,setShowModal:setShowModal,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.container// ref={modal}\n,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.createPostContainer,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.titleContainer,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Edit Comment\"}),/*#__PURE__*/_jsx(\"img\",{className:styles.x_svg,src:X_SVG,alt:\"exit\",onClick:function onClick(){return setShowModal(!showModal);}})]})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.contentContainer,children:[loading?/*#__PURE__*/_jsx(\"div\",{className:styles.LoadingSpinner,children:/*#__PURE__*/_jsx(LoadingSpinner,{})}):null,/*#__PURE__*/_jsx(\"div\",{className:styles.inputContainer,children:/*#__PURE__*/_jsx(\"textarea\",{// onChange={(e) => setPostText(e.target.value)}\nclassName:styles.input,value:commentText,onChange:function onChange(e){return setCommentText(e.target.value);},placeholder:\"What's on your mind, \".concat(currentUser.name,\"?\")// maxlength=\"1\"\n})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.postBtnContainer,children:[/*#__PURE__*/_jsx(\"button\",{className:\"\".concat(styles.editBtn,\" \").concat(styles.btn),onClick:function onClick(){return editCommentOnClick();},children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"\".concat(styles.deleteBtn,\" \").concat(styles.btn),onClick:function onClick(e){return deleteCommentOnClick();},children:\"Delete\"})]})]})]})});};export default EditDeleteComment;","map":{"version":3,"sources":["/Users/omarragab/Documents/Job/ResumeProject1/client/src/components/Home/EverythingPosts/EditDeleteComment/EditDeleteComment.js"],"names":["styles","React","useState","useEffect","useRef","Modal","useAppSelector","useAppDispatch","useMutation","useQuery","editCommentMutation","deleteCommentMutation","currentUserQuery","editPostMutation","LoadingSpinner","EditDeleteComment","comment","editComment","deleteComment","editPost","currentUser","state","showModal","setShowModal","commentText","setCommentText","loading","setLoading","editCommentOnClick","variables","id","refetchQueries","query","awaitRefetchQueries","then","res","catch","err","errors","graphQLErrors","map","error","message","console","log","deleteCommentOnClick","e","postId","container","createPostContainer","titleContainer","x_svg","X_SVG","contentContainer","inputContainer","input","target","value","name","postBtnContainer","editBtn","btn","deleteBtn"],"mappings":"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","sourcesContent":["import styles from \"./EditDeleteComment.module.css\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { Modal } from \"./modal/modal\";\nimport { useAppSelector, useAppDispatch } from \"../../../../redux/hooks\";\nimport X_SVG from \"./x.svg\";\nimport { useMutation, useQuery } from \"@apollo/client\";\nimport editCommentMutation from \"../../../../GQL/mutations/editComment\";\nimport deleteCommentMutation from \"../../../../GQL/mutations/deleteComment\";\nimport currentUserQuery from \"../../../../GQL/queries/CurrentUser\";\nimport editPostMutation from \"../../../../GQL/mutations/editPost\";\nimport LoadingSpinner from \"../../../LoadingSpinner/LoadingSpinner\";\n\nconst EditDeleteComment = ({ comment }) => {\n  const [editComment] = useMutation(editCommentMutation);\n  const [deleteComment] = useMutation(deleteCommentMutation);\n  const [editPost] = useMutation(editPostMutation);\n  // const { refetch } = useQuery(currentUserQuery);\n  const currentUser = useAppSelector((state) => state.currentUser);\n  const [showModal, setShowModal] = useState(false);\n  const [commentText, setCommentText] = useState(comment.comment);\n  const [loading, setLoading] = useState(false);\n  useEffect(() => {\n    setCommentText(comment.comment);\n  }, [comment]);\n\n  const editCommentOnClick = () => {\n    setLoading(true);\n    editComment({\n      variables: {\n        id: comment.id,\n        comment: commentText,\n      },\n      refetchQueries: [{ query: currentUserQuery }],\n      awaitRefetchQueries: true,\n    })\n      .then((res) => [setShowModal(false), setLoading(false)])\n      .catch((err) => {\n        const errors = err.graphQLErrors?.map((error) => error.message);\n        console.log(errors);\n      });\n  };\n  const deleteCommentOnClick = (e) => {\n    setLoading(true);\n    console.log(\"start\");\n    /* ----------------------------- delete comment ----------------------------- */\n    deleteComment({\n      variables: {\n        id: comment.id,\n      },\n      refetchQueries: [{ query: currentUserQuery }],\n      awaitRefetchQueries: true,\n    })\n      /* -----------------------------Delete Comment from Post--------------------------------------------- */\n      .then((res) =>\n        editPost({\n          variables: {\n            id: comment.postId,\n            deleteComment: comment.id,\n          },\n          refetchQueries: [{ query: currentUserQuery }],\n          awaitRefetchQueries: true,\n        })\n          .then([setShowModal(false), setLoading(false)])\n          .catch((err) => {\n            const errors = err.graphQLErrors?.map((error) => error.message);\n            console.log(errors);\n          })\n      )\n      .catch((err) => {\n        const errors = err.graphQLErrors?.map((error) => error.message);\n        console.log(errors);\n      });\n  };\n\n  if (!showModal) return <div onClick={() => setShowModal(true)}>...</div>;\n\n  return (\n    <Modal showModal={showModal} setShowModal={setShowModal}>\n      <div\n        className={styles.container}\n        // ref={modal}\n      >\n        <div className={styles.createPostContainer}>\n          <div className={styles.titleContainer}>\n            <h2>Edit Comment</h2>\n            <img\n              className={styles.x_svg}\n              src={X_SVG}\n              alt=\"exit\"\n              onClick={() => setShowModal(!showModal)}\n            />\n          </div>\n        </div>\n\n        <div className={styles.contentContainer}>\n          {loading ? (\n            <div className={styles.LoadingSpinner}>\n              <LoadingSpinner />\n            </div>\n          ) : null}\n          <div className={styles.inputContainer}>\n            <textarea\n              // onChange={(e) => setPostText(e.target.value)}\n              className={styles.input}\n              value={commentText}\n              onChange={(e) => setCommentText(e.target.value)}\n              placeholder={`What's on your mind, ${currentUser.name}?`}\n              // maxlength=\"1\"\n            ></textarea>\n          </div>\n          <div className={styles.postBtnContainer}>\n            <button\n              className={`${styles.editBtn} ${styles.btn}`}\n              onClick={() => editCommentOnClick()}\n            >\n              Edit\n            </button>\n            <button\n              className={`${styles.deleteBtn} ${styles.btn}`}\n              onClick={(e) => deleteCommentOnClick()}\n            >\n              Delete\n            </button>\n          </div>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nexport default EditDeleteComment;\n"]},"metadata":{},"sourceType":"module"}